{"platform":{"name":"gcp","release":"google-api-client-v0.52.0","target_id":"8f58cc4a-1c37-5ad5-b7ce-950b9375e19f"},"profiles":[{"name":"inspec-gcp","version":"1.10.37","sha256":"a0f8943097ecf8a005cafbbbc7b804b5cfa804bd074271ff479e352b82629def","title":"RK - GCP InSpec Profile","maintainer":"Ramesh Kasinathan","summary":"An InSpec Compliance Profile For GCP","license":"Apache-2.0","copyright":"Ramesh Kasinathan","copyright_email":"you@example.com","supports":[{"platform":"gcp"}],"attributes":[{"name":"gcp_Project_ID","options":{"type":"String","required":true,"value":"rk-devops-infra"}},{"name":"gcp_Project_Number","options":{"type":"Numeric","required":true,"value":190541024977}},{"name":"VPC_NETWORK_NAME","options":{"type":"String","required":true,"value":"main"}},{"name":"ROUTING_MODE","options":{"type":"String","required":true,"value":"REGIONAL"}},{"name":"k8s_container_cluster_location","options":{"type":"String","required":true,"value":"europe-west2-a"}},{"name":"k8s_container_cluster_name","options":{"type":"String","required":true,"value":"primary"}},{"name":"output_Enable_Compute_service_API","options":{"value":"compute.googleapis.com"}},{"name":"Enable_Compute_service_API","options":{"value":"compute.googleapis.com"}},{"name":"output_Enable_Container_service_API","options":{"value":"container.googleapis.com"}},{"name":"Enable_Container_service_API","options":{"value":"container.googleapis.com"}},{"name":"output_ROUTING_MODE","options":{"value":"REGIONAL"}},{"name":"output_VPC_NETWORK_NAME","options":{"value":"main"}},{"name":"output_compute_project_service","options":{"value":"compute.googleapis.com"}},{"name":"compute_project_service","options":{"value":"compute.googleapis.com"}},{"name":"output_compute_router_name","options":{"value":"router"}},{"name":"compute_router_name","options":{"value":"router"}},{"name":"output_compute_router_network","options":{"value":"https://www.googleapis.com/compute/v1/projects/rk-devops-infra/global/networks/main"}},{"name":"compute_router_network","options":{"value":"https://www.googleapis.com/compute/v1/projects/rk-devops-infra/global/networks/main"}},{"name":"output_compute_router_region","options":{"value":"europe-west2"}},{"name":"compute_router_region","options":{"value":"europe-west2"}},{"name":"output_compute_subnetwork_Secondary_ip_cidr_range_name","options":{"value":["k8s-pod-range","k8s-service-range"]}},{"name":"compute_subnetwork_Secondary_ip_cidr_range_name","options":{"value":["k8s-pod-range","k8s-service-range"]}},{"name":"output_compute_subnetwork_google_pip_access","options":{"value":true}},{"name":"compute_subnetwork_google_pip_access","options":{"value":true}},{"name":"output_compute_subnetwork_id","options":{"value":"projects/rk-devops-infra/regions/europe-west2/subnetworks/private"}},{"name":"compute_subnetwork_id","options":{"value":"projects/rk-devops-infra/regions/europe-west2/subnetworks/private"}},{"name":"output_compute_subnetwork_ip_cidr","options":{"value":"10.0.0.0/18"}},{"name":"compute_subnetwork_ip_cidr","options":{"value":"10.0.0.0/18"}},{"name":"output_compute_subnetwork_name","options":{"value":"private"}},{"name":"compute_subnetwork_name","options":{"value":"private"}},{"name":"output_compute_subnetwork_project_name","options":{"value":"rk-devops-infra"}},{"name":"compute_subnetwork_project_name","options":{"value":"rk-devops-infra"}},{"name":"output_compute_subnetwork_region","options":{"value":"europe-west2"}},{"name":"compute_subnetwork_region","options":{"value":"europe-west2"}},{"name":"output_container_project_service","options":{"value":"container.googleapis.com"}},{"name":"container_project_service","options":{"value":"container.googleapis.com"}},{"name":"output_firewall_name","options":{"value":"allow-ssh"}},{"name":"firewall_name","options":{"value":"allow-ssh"}},{"name":"output_firewall_source_direction","options":{"value":"INGRESS"}},{"name":"firewall_source_direction","options":{"value":"INGRESS"}},{"name":"output_firewall_source_priority","options":{"value":1000}},{"name":"firewall_source_priority","options":{"value":1000}},{"name":"output_firewall_source_range","options":{"value":["0.0.0.0/0"]}},{"name":"firewall_source_range","options":{"value":["0.0.0.0/0"]}},{"name":"output_gcp_Project_ID","options":{"value":"rk-devops-infra"}},{"name":"output_gcp_Project_Number","options":{"value":190541024977}},{"name":"output_google_container_nodepool_general_max_pods","options":{"value":110}},{"name":"google_container_nodepool_general_max_pods","options":{"value":110}},{"name":"output_google_container_nodepool_general_name","options":{"value":"general"}},{"name":"google_container_nodepool_general_name","options":{"value":"general"}},{"name":"output_google_container_nodepool_general_node_count","options":{"value":1}},{"name":"google_container_nodepool_general_node_count","options":{"value":1}},{"name":"output_google_container_nodepool_spot_max_pods","options":{"value":110}},{"name":"google_container_nodepool_spot_max_pods","options":{"value":110}},{"name":"output_google_container_nodepool_spot_name","options":{"value":"spot"}},{"name":"google_container_nodepool_spot_name","options":{"value":"spot"}},{"name":"output_google_container_nodepool_spot_node_count","options":{"value":0}},{"name":"google_container_nodepool_spot_node_count","options":{"value":0}},{"name":"output_google_sa_kubernetes","options":{"value":"projects/rk-devops-infra/serviceAccounts/kubernetes@rk-devops-infra.iam.gserviceaccount.com"}},{"name":"google_sa_kubernetes","options":{"value":"projects/rk-devops-infra/serviceAccounts/kubernetes@rk-devops-infra.iam.gserviceaccount.com"}},{"name":"output_google_sa_kubernetes_email","options":{"value":"kubernetes@rk-devops-infra.iam.gserviceaccount.com"}},{"name":"google_sa_kubernetes_email","options":{"value":"kubernetes@rk-devops-infra.iam.gserviceaccount.com"}},{"name":"output_k8s_container_cluster_cidr","options":{"value":"10.48.0.0/14"}},{"name":"k8s_container_cluster_cidr","options":{"value":"10.48.0.0/14"}},{"name":"output_k8s_container_cluster_location","options":{"value":"europe-west2-a"}},{"name":"output_k8s_container_cluster_name","options":{"value":"primary"}},{"name":"output_k8s_container_cluster_network","options":{"value":"projects/rk-devops-infra/global/networks/main"}},{"name":"k8s_container_cluster_network","options":{"value":"projects/rk-devops-infra/global/networks/main"}},{"name":"output_k8s_container_cluster_nw_mode","options":{"value":"VPC_NATIVE"}},{"name":"k8s_container_cluster_nw_mode","options":{"value":"VPC_NATIVE"}},{"name":"output_k8s_container_cluster_services_ipv4_cidr","options":{"value":"10.52.0.0/20"}},{"name":"k8s_container_cluster_services_ipv4_cidr","options":{"value":"10.52.0.0/20"}},{"name":"output_nat_address","options":{"value":"35.246.123.31"}},{"name":"nat_address","options":{"value":"35.246.123.31"}},{"name":"output_nat_address_name","options":{"value":"nat"}},{"name":"nat_address_name","options":{"value":"nat"}},{"name":"output_nat_address_region","options":{"value":"europe-west2"}},{"name":"nat_address_region","options":{"value":"europe-west2"}},{"name":"output_nat_address_tier","options":{"value":"PREMIUM"}},{"name":"nat_address_tier","options":{"value":"PREMIUM"}}],"depends":[{"name":"inspec-gcp","url":"https://github.com/inspec/inspec-gcp/archive/main.tar.gz","status":"loaded"}],"groups":[{"id":"controls/gcp_tf_utc.rb","controls":["gcp_tf_utc"],"title":"GCP - GKE Test Cases"}],"controls":[{"id":"gcp_tf_utc","title":"Check GCP Project Info","desc":null,"descriptions":[],"impact":1.0,"refs":[],"tags":{},"code":"control 'gcp_tf_utc' do\n  impact 1.0\n\n  title 'Check GCP Project Info'\n  describe google_project(project: PROJECT_ID) do\n    it { should exist }\n    its('name') { should eq PROJECT_ID }\n    its('project_number') { should eq PROJECT_NUMBER }\n    its('lifecycle_state') { should eq 'ACTIVE' }\n  end\n\n  # GCP GKE Cluster Units Test cases\n\n  describe google_container_cluster(project: PROJECT_ID, location: CLUSTER_ZONE, name: CLUSTER_NAME) do\n    it { should exist }\n    its('name') { should eq CLUSTER_NAME }\n    its('status') { should eq 'RUNNING' }\n    its('location') { should match CLUSTER_ZONE }\n    its('network') { should eq VPC_NW_NAME }\n    its('subnetwork') { should eq 'private' }\n    its('initial_node_count') { should eq 1 }\n    its('node_config.disk_size_gb') { should eq 100 }\n    its('node_config.image_type') { should eq \"COS_CONTAINERD\" }\n    its('node_pools.count') { should eq 2 }\n    its('private_cluster_config.enable_private_nodes') { should eq true }\n  end\n\n  google_compute_networks(project: PROJECT_ID).network_names.each do |network_name|\n    describe google_compute_network(project: PROJECT_ID,  name: network_name) do\n      its ('subnetworks.count') { should be < 60 }\n      its ('creation_timestamp_date') { should be > Time.now - 365*60*60*24*10 }\n      its ('routing_config.routing_mode') { should eq \"REGIONAL\" }\n    end\n  end\n\nend\n","source_location":{"line":10,"ref":"C:/DevOps_Workspace/Terraform_Woskspace/Terraform-manifests/GCP-GKE-IAC/test/integration/vpc_module/controls/gcp_tf_utc.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Project rk-devops-infra is expected to exist","run_time":0.0024483,"start_time":"2022-08-22T19:35:26+01:00","resource_class":"google_project","resource_params":"[{:project=>\"rk-devops-infra\"}]"},{"status":"passed","code_desc":"Project rk-devops-infra name is expected to eq \"rk-devops-infra\"","run_time":0.002223,"start_time":"2022-08-22T19:35:26+01:00","resource_class":"google_project","resource_params":"[{:project=>\"rk-devops-infra\"}]"},{"status":"passed","code_desc":"Project rk-devops-infra project_number is expected to eq 190541024977","run_time":0.0001776,"start_time":"2022-08-22T19:35:26+01:00","resource_class":"google_project","resource_params":"[{:project=>\"rk-devops-infra\"}]"},{"status":"passed","code_desc":"Project rk-devops-infra lifecycle_state is expected to eq \"ACTIVE\"","run_time":5.41e-05,"start_time":"2022-08-22T19:35:26+01:00","resource_class":"google_project","resource_params":"[{:project=>\"rk-devops-infra\"}]"},{"status":"passed","code_desc":"Cluster primary is expected to exist","run_time":6.03e-05,"start_time":"2022-08-22T19:35:26+01:00","resource_class":"google_container_cluster","resource_params":"[{:project=>\"rk-devops-infra\", :location=>\"europe-west2-a\", :name=>\"primary\"}]"},{"status":"passed","code_desc":"Cluster primary name is expected to eq \"primary\"","run_time":4.86e-05,"start_time":"2022-08-22T19:35:26+01:00","resource_class":"google_container_cluster","resource_params":"[{:project=>\"rk-devops-infra\", :location=>\"europe-west2-a\", :name=>\"primary\"}]"},{"status":"passed","code_desc":"Cluster primary status is expected to eq \"RUNNING\"","run_time":4.69e-05,"start_time":"2022-08-22T19:35:26+01:00","resource_class":"google_container_cluster","resource_params":"[{:project=>\"rk-devops-infra\", :location=>\"europe-west2-a\", :name=>\"primary\"}]"},{"status":"passed","code_desc":"Cluster primary location is expected to match \"europe-west2-a\"","run_time":0.0031391,"start_time":"2022-08-22T19:35:26+01:00","resource_class":"google_container_cluster","resource_params":"[{:project=>\"rk-devops-infra\", :location=>\"europe-west2-a\", :name=>\"primary\"}]"},{"status":"passed","code_desc":"Cluster primary network is expected to eq \"main\"","run_time":0.0001113,"start_time":"2022-08-22T19:35:26+01:00","resource_class":"google_container_cluster","resource_params":"[{:project=>\"rk-devops-infra\", :location=>\"europe-west2-a\", :name=>\"primary\"}]"},{"status":"passed","code_desc":"Cluster primary subnetwork is expected to eq \"private\"","run_time":5.26e-05,"start_time":"2022-08-22T19:35:26+01:00","resource_class":"google_container_cluster","resource_params":"[{:project=>\"rk-devops-infra\", :location=>\"europe-west2-a\", :name=>\"primary\"}]"},{"status":"passed","code_desc":"Cluster primary initial_node_count is expected to eq 1","run_time":0.0001291,"start_time":"2022-08-22T19:35:26+01:00","resource_class":"google_container_cluster","resource_params":"[{:project=>\"rk-devops-infra\", :location=>\"europe-west2-a\", :name=>\"primary\"}]"},{"status":"passed","code_desc":"Cluster primary node_config.disk_size_gb is expected to eq 100","run_time":5.14e-05,"start_time":"2022-08-22T19:35:26+01:00","resource_class":"google_container_cluster","resource_params":"[{:project=>\"rk-devops-infra\", :location=>\"europe-west2-a\", :name=>\"primary\"}]"},{"status":"passed","code_desc":"Cluster primary node_config.image_type is expected to eq \"COS_CONTAINERD\"","run_time":5.2e-05,"start_time":"2022-08-22T19:35:26+01:00","resource_class":"google_container_cluster","resource_params":"[{:project=>\"rk-devops-infra\", :location=>\"europe-west2-a\", :name=>\"primary\"}]"},{"status":"passed","code_desc":"Cluster primary node_pools.count is expected to eq 2","run_time":7.91e-05,"start_time":"2022-08-22T19:35:26+01:00","resource_class":"google_container_cluster","resource_params":"[{:project=>\"rk-devops-infra\", :location=>\"europe-west2-a\", :name=>\"primary\"}]"},{"status":"passed","code_desc":"Cluster primary private_cluster_config.enable_private_nodes is expected to eq true","run_time":5.28e-05,"start_time":"2022-08-22T19:35:26+01:00","resource_class":"google_container_cluster","resource_params":"[{:project=>\"rk-devops-infra\", :location=>\"europe-west2-a\", :name=>\"primary\"}]"},{"status":"passed","code_desc":"Network default subnetworks.count is expected to be < 60","run_time":0.0032366,"start_time":"2022-08-22T19:35:26+01:00","resource_class":"google_compute_network","resource_params":"[{:project=>\"rk-devops-infra\", :name=>\"default\"}]"},{"status":"passed","code_desc":"Network default creation_timestamp_date is expected to be > 2012-08-24 19:35:26 +0100","run_time":0.0001219,"start_time":"2022-08-22T19:35:26+01:00","resource_class":"google_compute_network","resource_params":"[{:project=>\"rk-devops-infra\", :name=>\"default\"}]"},{"status":"passed","code_desc":"Network default routing_config.routing_mode is expected to eq \"REGIONAL\"","run_time":0.0001736,"start_time":"2022-08-22T19:35:26+01:00","resource_class":"google_compute_network","resource_params":"[{:project=>\"rk-devops-infra\", :name=>\"default\"}]"},{"status":"passed","code_desc":"Network main subnetworks.count is expected to be < 60","run_time":6.19e-05,"start_time":"2022-08-22T19:35:26+01:00","resource_class":"google_compute_network","resource_params":"[{:project=>\"rk-devops-infra\", :name=>\"main\"}]"},{"status":"passed","code_desc":"Network main creation_timestamp_date is expected to be > 2012-08-24 19:35:26 +0100","run_time":5.73e-05,"start_time":"2022-08-22T19:35:26+01:00","resource_class":"google_compute_network","resource_params":"[{:project=>\"rk-devops-infra\", :name=>\"main\"}]"},{"status":"passed","code_desc":"Network main routing_config.routing_mode is expected to eq \"REGIONAL\"","run_time":5.88e-05,"start_time":"2022-08-22T19:35:26+01:00","resource_class":"google_compute_network","resource_params":"[{:project=>\"rk-devops-infra\", :name=>\"main\"}]"}]}],"status":"loaded","status_message":""},{"name":"inspec-gcp","version":"1.10.37","sha256":"b91e7a1a1cf5e426e6f1ccd812aaa85956d7ed967587fd791ffea930b008f815","title":"Google Cloud Platform Resource Pack","maintainer":"spaterson@chef.io,russell.seymour@turtlesystems.co.uk","summary":"This resource pack provides compliance resources_old_ignore for Google Cloud Platform","license":"Apache-2.0","copyright":"spaterson@chef.io,russell.seymour@turtlesystems.co.uk","copyright_email":"spaterson@chef.io,russell.seymour@turtlesystems.co.uk","supports":[{"platform":"gcp"}],"attributes":[{"name":"gcp_Project_ID","options":{"type":"String","required":true,"value":"rk-devops-infra"}},{"name":"gcp_Project_Number","options":{"type":"Numeric","required":true,"value":190541024977}},{"name":"VPC_NETWORK_NAME","options":{"type":"String","required":true,"value":"main"}},{"name":"ROUTING_MODE","options":{"type":"String","required":true,"value":"REGIONAL"}},{"name":"k8s_container_cluster_location","options":{"type":"String","required":true,"value":"europe-west2-a"}},{"name":"k8s_container_cluster_name","options":{"type":"String","required":true,"value":"primary"}},{"name":"output_Enable_Compute_service_API","options":{"value":"compute.googleapis.com"}},{"name":"Enable_Compute_service_API","options":{"value":"compute.googleapis.com"}},{"name":"output_Enable_Container_service_API","options":{"value":"container.googleapis.com"}},{"name":"Enable_Container_service_API","options":{"value":"container.googleapis.com"}},{"name":"output_ROUTING_MODE","options":{"value":"REGIONAL"}},{"name":"output_VPC_NETWORK_NAME","options":{"value":"main"}},{"name":"output_compute_project_service","options":{"value":"compute.googleapis.com"}},{"name":"compute_project_service","options":{"value":"compute.googleapis.com"}},{"name":"output_compute_router_name","options":{"value":"router"}},{"name":"compute_router_name","options":{"value":"router"}},{"name":"output_compute_router_network","options":{"value":"https://www.googleapis.com/compute/v1/projects/rk-devops-infra/global/networks/main"}},{"name":"compute_router_network","options":{"value":"https://www.googleapis.com/compute/v1/projects/rk-devops-infra/global/networks/main"}},{"name":"output_compute_router_region","options":{"value":"europe-west2"}},{"name":"compute_router_region","options":{"value":"europe-west2"}},{"name":"output_compute_subnetwork_Secondary_ip_cidr_range_name","options":{"value":["k8s-pod-range","k8s-service-range"]}},{"name":"compute_subnetwork_Secondary_ip_cidr_range_name","options":{"value":["k8s-pod-range","k8s-service-range"]}},{"name":"output_compute_subnetwork_google_pip_access","options":{"value":true}},{"name":"compute_subnetwork_google_pip_access","options":{"value":true}},{"name":"output_compute_subnetwork_id","options":{"value":"projects/rk-devops-infra/regions/europe-west2/subnetworks/private"}},{"name":"compute_subnetwork_id","options":{"value":"projects/rk-devops-infra/regions/europe-west2/subnetworks/private"}},{"name":"output_compute_subnetwork_ip_cidr","options":{"value":"10.0.0.0/18"}},{"name":"compute_subnetwork_ip_cidr","options":{"value":"10.0.0.0/18"}},{"name":"output_compute_subnetwork_name","options":{"value":"private"}},{"name":"compute_subnetwork_name","options":{"value":"private"}},{"name":"output_compute_subnetwork_project_name","options":{"value":"rk-devops-infra"}},{"name":"compute_subnetwork_project_name","options":{"value":"rk-devops-infra"}},{"name":"output_compute_subnetwork_region","options":{"value":"europe-west2"}},{"name":"compute_subnetwork_region","options":{"value":"europe-west2"}},{"name":"output_container_project_service","options":{"value":"container.googleapis.com"}},{"name":"container_project_service","options":{"value":"container.googleapis.com"}},{"name":"output_firewall_name","options":{"value":"allow-ssh"}},{"name":"firewall_name","options":{"value":"allow-ssh"}},{"name":"output_firewall_source_direction","options":{"value":"INGRESS"}},{"name":"firewall_source_direction","options":{"value":"INGRESS"}},{"name":"output_firewall_source_priority","options":{"value":1000}},{"name":"firewall_source_priority","options":{"value":1000}},{"name":"output_firewall_source_range","options":{"value":["0.0.0.0/0"]}},{"name":"firewall_source_range","options":{"value":["0.0.0.0/0"]}},{"name":"output_gcp_Project_ID","options":{"value":"rk-devops-infra"}},{"name":"output_gcp_Project_Number","options":{"value":190541024977}},{"name":"output_google_container_nodepool_general_max_pods","options":{"value":110}},{"name":"google_container_nodepool_general_max_pods","options":{"value":110}},{"name":"output_google_container_nodepool_general_name","options":{"value":"general"}},{"name":"google_container_nodepool_general_name","options":{"value":"general"}},{"name":"output_google_container_nodepool_general_node_count","options":{"value":1}},{"name":"google_container_nodepool_general_node_count","options":{"value":1}},{"name":"output_google_container_nodepool_spot_max_pods","options":{"value":110}},{"name":"google_container_nodepool_spot_max_pods","options":{"value":110}},{"name":"output_google_container_nodepool_spot_name","options":{"value":"spot"}},{"name":"google_container_nodepool_spot_name","options":{"value":"spot"}},{"name":"output_google_container_nodepool_spot_node_count","options":{"value":0}},{"name":"google_container_nodepool_spot_node_count","options":{"value":0}},{"name":"output_google_sa_kubernetes","options":{"value":"projects/rk-devops-infra/serviceAccounts/kubernetes@rk-devops-infra.iam.gserviceaccount.com"}},{"name":"google_sa_kubernetes","options":{"value":"projects/rk-devops-infra/serviceAccounts/kubernetes@rk-devops-infra.iam.gserviceaccount.com"}},{"name":"output_google_sa_kubernetes_email","options":{"value":"kubernetes@rk-devops-infra.iam.gserviceaccount.com"}},{"name":"google_sa_kubernetes_email","options":{"value":"kubernetes@rk-devops-infra.iam.gserviceaccount.com"}},{"name":"output_k8s_container_cluster_cidr","options":{"value":"10.48.0.0/14"}},{"name":"k8s_container_cluster_cidr","options":{"value":"10.48.0.0/14"}},{"name":"output_k8s_container_cluster_location","options":{"value":"europe-west2-a"}},{"name":"output_k8s_container_cluster_name","options":{"value":"primary"}},{"name":"output_k8s_container_cluster_network","options":{"value":"projects/rk-devops-infra/global/networks/main"}},{"name":"k8s_container_cluster_network","options":{"value":"projects/rk-devops-infra/global/networks/main"}},{"name":"output_k8s_container_cluster_nw_mode","options":{"value":"VPC_NATIVE"}},{"name":"k8s_container_cluster_nw_mode","options":{"value":"VPC_NATIVE"}},{"name":"output_k8s_container_cluster_services_ipv4_cidr","options":{"value":"10.52.0.0/20"}},{"name":"k8s_container_cluster_services_ipv4_cidr","options":{"value":"10.52.0.0/20"}},{"name":"output_nat_address","options":{"value":"35.246.123.31"}},{"name":"nat_address","options":{"value":"35.246.123.31"}},{"name":"output_nat_address_name","options":{"value":"nat"}},{"name":"nat_address_name","options":{"value":"nat"}},{"name":"output_nat_address_region","options":{"value":"europe-west2"}},{"name":"nat_address_region","options":{"value":"europe-west2"}},{"name":"output_nat_address_tier","options":{"value":"PREMIUM"}},{"name":"nat_address_tier","options":{"value":"PREMIUM"}}],"parent_profile":"inspec-gcp","groups":[],"controls":[],"status":"loaded","status_message":""}],"statistics":{"duration":0.0188603},"version":"4.56.20"}